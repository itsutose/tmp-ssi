# Advanced RAG システム実装 Issue一覧

## 実装推奨順序

### フェーズ1: インフラ基盤構築
1. **INFRA-001**: DynamoDB テーブル群作成
2. **INFRA-002**: S3 バケット構成作成
3. **INFRA-006**: ECR リポジトリ設定
4. **INFRA-008**: Secrets Manager設定
5. **INFRA-010**: IAM ロール・ポリシー設定

### フェーズ2: AI/MLサービス統合
6. **INFRA-013**: Vector Database統合設定
7. **INFRA-014**: Bedrock統合・LLMモデル設定
8. **INFRA-015**: 環境変数・設定管理強化

### フェーズ3: Lambda・API基盤
9. **INFRA-005**: Lambda関数設定・ECR連携
10. **INFRA-004**: API Gateway REST API設定
11. **RAG-001**: 設定管理システム実装
12. **RAG-002**: 基本RAGプロセッサー基盤実装

### フェーズ4: RAGコア機能
13. **RAG-010**: REST APIエンドポイント基盤実装
14. **RAG-003**: クエリ拡張システム実装
15. **RAG-005**: ベクトル検索システム実装
16. **RAG-006**: ハイブリッド検索システム実装
17. **RAG-008**: RAG Fusion処理システム実装

### フェーズ5: Advanced機能
18. **RAG-004**: HyDE実装
19. **RAG-007**: 検索結果圧縮システム実装
20. **RAG-009**: メタデータ圧縮システム実装
21. **RAG-011**: Advanced RAGクエリAPI実装
22. **RAG-012**: チェック機能API実装

### フェーズ6: ドキュメント処理
23. **RAG-015**: docling統合ドキュメント処理システム実装
24. **RAG-016**: 高度チャンキング戦略実装
25. **RAG-017**: ベクトル化・インデックス処理システム実装
26. **RAG-013**: 文書管理API実装
27. **RAG-018**: 文書処理パイプライン統合実装

### フェーズ7: 運用・監視
28. **RAG-014**: 履歴・設定管理API実装
29. **INFRA-009**: CloudWatch 監視・ログ設定
30. **INFRA-007**: Step Functions ワークフロー設定
31. **RAG-019**: セキュリティ・監査機能実装
32. **INFRA-012**: セキュリティ設定・監査

### フェーズ8: 最終統合
33. **INFRA-011**: 環境別デプロイメント設定
34. **INFRA-003**: Cognito ユーザープール設定

## Issue テンプレート

```markdown
## Issue タイトル
**優先度**: High/Medium/Low
**カテゴリ**: 基盤/Pre-retrieval/Retrieval/Post-retrieval/API/ドキュメント処理/セキュリティ
**依存関係**: [関連Issue番号]

### 課題概要
[課題の概要を簡潔に記述]

### 実装詳細
- [ ] 詳細タスク1
- [ ] 詳細タスク2
- [ ] 詳細タスク3

### 技術要件
- 使用技術: [技術スタック]
- 制約事項: [制約・注意点]

### テスト項目
- [ ] 単体テスト
- [ ] 統合テスト
- [ ] E2Eテスト

### 完了条件
- [ ] 機能実装完了
- [ ] テスト完了
- [ ] ドキュメント更新
```

---

# 基盤モジュール

## RAG-001: 設定管理システム実装
**優先度**: High
**カテゴリ**: 基盤
**依存関係**: INFRA-001, INFRA-002, INFRA-008

### 課題概要
AWS、LLM、VectorDB、Embeddingの統一設定管理システムを実装する。環境変数とSecrets Managerからの設定読み込みを統合管理する。

### 実装詳細
- [ ] AWSConfig クラス実装 (boto3セッション管理)
- [ ] LLMConfig クラス実装 (Bedrock Claude設定)
- [ ] VectorDBConfig クラス実装 (Chroma/Pinecone設定)
- [ ] EmbeddingConfig クラス実装 (Bedrock Embedding設定)
- [ ] 環境変数管理システム実装
- [ ] Secrets Manager統合実装
- [ ] 設定検証・ヘルスチェック機能実装
- [ ] 設定キャッシュ機能実装

### 技術要件
- 使用技術: boto3, Pydantic Settings, AWS Secrets Manager
- 制約事項: Lambda環境対応、コールドスタート最適化、設定キャッシュ

### テスト項目
- [ ] 設定読み込みテスト
- [ ] AWS接続テスト
- [ ] 設定検証テスト
- [ ] エラーハンドリングテスト

### 完了条件
- [ ] 全設定クラス動作確認
- [ ] AWS統合確認
- [ ] 設定検証機能確認

---

## RAG-002: 基本RAGプロセッサー基盤実装
**優先度**: High
**カテゴリ**: 基盤
**依存関係**: RAG-001

### 課題概要
Advanced RAGシステムの基本抽象クラスとプロセッサー基盤を実装する。全RAGコンポーネントの共通インターフェースを提供する。

### 実装詳細
- [ ] BaseRAGProcessor 抽象クラス実装
- [ ] BaseRetrieverConfig 抽象クラス実装
- [ ] 共通プロンプト管理インターフェース実装
- [ ] LangChain統合基盤実装
- [ ] エラーハンドリング基盤実装
- [ ] ログ管理基盤実装
- [ ] メトリクス収集基盤実装

### 技術要件
- 使用技術: LangChain Core, abc module, Python typing
- 制約事項: 抽象化レベル、拡張性、パフォーマンス

### テスト項目
- [ ] 抽象クラステスト
- [ ] インターフェーステスト
- [ ] 継承動作テスト
- [ ] エラーハンドリングテスト

### 完了条件
- [ ] 基本プロセッサー動作確認
- [ ] インターフェース統一確認
- [ ] 拡張性確認

---

# Pre-retrieval モジュール

## RAG-003: クエリ拡張システム実装
**優先度**: High
**カテゴリ**: Pre-retrieval
**依存関係**: RAG-002

### 課題概要
入力クエリを複数の検索用クエリに拡張するQueryExtensionシステムを実装する。検索精度向上のためのクエリ多様化を行う。

### 実装詳細
- [ ] QueryExtension クラス実装
- [ ] マルチクエリ生成機能実装
- [ ] クエリ品質評価機能実装
- [ ] クエリフィルタリング機能実装
- [ ] LLMプロンプト最適化実装
- [ ] クエリ生成結果パーサー実装
- [ ] クエリ生成ログ機能実装

### 技術要件
- 使用技術: LangChain, Bedrock Claude, Pydantic
- 制約事項: レスポンス時間5秒以内、クエリ数3-5個

### テスト項目
- [ ] クエリ拡張機能テスト
- [ ] 生成品質テスト
- [ ] パフォーマンステスト
- [ ] エッジケーステスト

### 完了条件
- [ ] クエリ拡張動作確認
- [ ] 品質基準満足確認
- [ ] パフォーマンス要件確認

---

## RAG-004: HyDE (Hypothetical Document Embeddings) 実装
**優先度**: Medium
**カテゴリ**: Pre-retrieval
**依存関係**: RAG-002

### 課題概要
仮想的な回答文書を生成してembeddingベースの検索精度を向上させるHyDEシステムを実装する。

### 実装詳細
- [ ] HyDE クラス実装
- [ ] 仮想回答生成機能実装
- [ ] 仮想文書品質評価機能実装
- [ ] Embedding生成・検索統合実装
- [ ] HyDEプロンプト最適化実装
- [ ] パフォーマンス最適化実装

### 技術要件
- 使用技術: LangChain, Bedrock Claude, Bedrock Embeddings
- 制約事項: 生成時間制限、品質保証

### テスト項目
- [ ] 仮想文書生成テスト
- [ ] 検索精度向上テスト
- [ ] パフォーマンステスト

### 完了条件
- [ ] HyDE機能動作確認
- [ ] 検索精度向上確認
- [ ] 統合動作確認

---

# Retrieval モジュール

## RAG-005: Pinecone ベクトル検索システム実装
**優先度**: High
**カテゴリ**: Retrieval
**依存関係**: RAG-001, INFRA-013, INFRA-014

### 課題概要
Pinecone Vector Databaseとの統合検索システムを実装する。効率的なベクトル検索とメタデータフィルタリングを提供する。

### 実装詳細
- [ ] PineconeRetriever クラス実装
- [ ] Pinecone ベクトル類似度検索実装
- [ ] メタデータフィルタリング実装 (category, tags, document_id等)
- [ ] 検索結果ランキング・スコアリング実装
- [ ] バッチ検索機能実装
- [ ] Pinecone API制限対応・レート制御実装
- [ ] 検索パフォーマンス最適化実装
- [ ] 検索結果キャッシュ機能実装
- [ ] Pinecone接続エラー処理・フォールバック実装

### 技術要件
- 使用技術: Pinecone SDK, Bedrock Embeddings, numpy
- 制約事項: 検索時間3秒以内、最大1000件検索、Pinecone API制限対応

### テスト項目
- [ ] Pinecone ベクトル検索機能テスト
- [ ] メタデータフィルタテスト
- [ ] パフォーマンステスト
- [ ] API制限・エラーハンドリングテスト
- [ ] キャッシュ機能テスト

### 完了条件
- [ ] Pinecone ベクトル検索動作確認
- [ ] フィルタ機能確認
- [ ] パフォーマンス要件確認

---

## RAG-006: ハイブリッド検索システム実装
**優先度**: High
**カテゴリ**: Retrieval
**依存関係**: RAG-005

### 課題概要
Pinecone ベクトル検索とキーワード検索(BM25)を組み合わせたハイブリッド検索システムを実装する。

### 実装詳細
- [ ] HybridRetriever クラス実装
- [ ] BM25キーワード検索実装
- [ ] Pinecone ベクトル・キーワード検索統合実装
- [ ] スコア正規化・統合実装
- [ ] 検索戦略選択機能実装
- [ ] 結果マージング機能実装
- [ ] 検索品質評価機能実装
- [ ] Pinecone + BM25 スコア重み付け調整実装

### 技術要件
- 使用技術: BM25Okapi, Pinecone SDK, scikit-learn
- 制約事項: 検索時間5秒以内、精度バランス最適化、Pinecone API制限対応

### テスト項目
- [ ] ハイブリッド検索機能テスト
- [ ] スコア統合テスト
- [ ] 検索品質テスト
- [ ] パフォーマンステスト

### 完了条件
- [ ] ハイブリッド検索動作確認
- [ ] 検索品質基準確認
- [ ] 統合機能確認

---

## RAG-007: 検索結果圧縮システム実装
**優先度**: Medium
**カテゴリ**: Retrieval
**依存関係**: RAG-005

### 課題概要
大量の検索結果を効率的に圧縮・選別するCompressionRetrieverシステムを実装する。

### 実装詳細
- [ ] CompressionRetriever クラス実装
- [ ] 文書関連度スコアリング実装
- [ ] 冗長性除去機能実装
- [ ] 文書要約・圧縮機能実装
- [ ] 圧縮率調整機能実装
- [ ] 品質保持機能実装

### 技術要件
- 使用技術: LangChain, Bedrock Claude, TF-IDF
- 制約事項: 圧縮率50-80%、品質劣化最小化

### テスト項目
- [ ] 圧縮機能テスト
- [ ] 品質保持テスト
- [ ] 圧縮率テスト

### 完了条件
- [ ] 圧縮機能動作確認
- [ ] 品質基準確認
- [ ] 統合動作確認

---

# Post-retrieval モジュール

## RAG-008: RAG Fusion処理システム実装
**優先度**: High
**カテゴリ**: Post-retrieval
**依存関係**: RAG-003, RAG-006

### 課題概要
複数クエリの検索結果をRank Fusionアルゴリズムで統合するRagFusionProcessorを実装する。

### 実装詳細
- [ ] RagFusionProcessor クラス実装
- [ ] Reciprocal Rank Fusion (RRF) アルゴリズム実装
- [ ] 複数検索結果マージング機能実装
- [ ] ランキングスコア正規化実装
- [ ] 重複除去機能実装
- [ ] 最終結果ランキング実装
- [ ] Fusionパフォーマンス最適化実装

### 技術要件
- 使用技術: LangChain, numpy, collections
- 制約事項: 処理時間2秒以内、精度向上保証

### テスト項目
- [ ] RRFアルゴリズムテスト
- [ ] マージング機能テスト
- [ ] ランキング品質テスト
- [ ] パフォーマンステスト

### 完了条件
- [ ] RAG Fusion動作確認
- [ ] ランキング品質確認
- [ ] 統合機能確認

---

## RAG-009: メタデータ圧縮システム実装
**優先度**: Medium
**カテゴリ**: Post-retrieval
**依存関係**: RAG-008

### 課題概要
検索結果のメタデータを圧縮・要約するMetadataCompressionシステムを実装する。LLMを使用して関連性の高い情報のみを抽出する。

### 実装詳細
- [ ] MetadataCompression クラス実装
- [ ] LLMベース文書要約機能実装
- [ ] 関連度フィルタリング機能実装
- [ ] メタデータ構造化実装
- [ ] 圧縮プロンプト最適化実装
- [ ] 圧縮品質評価機能実装
- [ ] バッチ圧縮機能実装

### 技術要件
- 使用技術: LangChain, Bedrock Claude, Pydantic
- 制約事項: 圧縮時間5秒以内、情報損失最小化

### テスト項目
- [ ] 圧縮機能テスト
- [ ] 品質評価テスト
- [ ] バッチ処理テスト
- [ ] パフォーマンステスト

### 完了条件
- [ ] 圧縮機能動作確認
- [ ] 品質基準確認
- [ ] バッチ処理確認

---

# API層

## RAG-010: REST APIエンドポイント基盤実装
**優先度**: High
**カテゴリ**: API
**依存関係**: RAG-001, INFRA-004, INFRA-005

### 課題概要
FastAPIを使用したRESTfulAPIエンドポイントの基盤を実装する。Mangumを使用してLambda環境でFastAPIを動作させる。認証はAPI Gateway Cognito Authorizerで行う。

### 実装詳細
- [ ] FastAPIアプリケーション基盤構築
- [ ] Mangumアダプターの設定
- [ ] 共通レスポンス形式の実装 (Pydantic BaseModel)
- [ ] ヘルスチェックエンドポイント実装 (`GET /health`, `GET /rag/health`)
- [ ] CORS設定とHTTPヘッダー設定
- [ ] OpenAPI仕様書自動生成設定
- [ ] 共通ミドルウェア実装 (ログ、メトリクス)
- [ ] リクエスト/レスポンス検証実装

### 技術要件
- 使用技術: FastAPI, Mangum, Pydantic, uvicorn
- 制約事項: Lambda環境での動作、API Gateway連携、コールドスタート最適化

### テスト項目
- [ ] ヘルスチェックAPIテスト
- [ ] レスポンス形式テスト
- [ ] CORS動作テスト
- [ ] Lambda統合テスト

### 完了条件
- [ ] 基本APIエンドポイント動作確認
- [ ] Lambda環境でのFastAPI動作確認
- [ ] OpenAPI仕様書生成確認

---

## RAG-011: Advanced RAGクエリAPI実装
**優先度**: High
**カテゴリ**: API
**依存関係**: RAG-003, RAG-008, RAG-009, RAG-010

### 課題概要
`POST /rag/query`エンドポイントを実装し、Advanced RAGパイプライン全体を統合したクエリ処理を提供する。

### 実装詳細
- [ ] RAGクエリリクエスト/レスポンスモデル定義
- [ ] RAGService統合クラス実装
- [ ] 全RAGコンポーネント統合実装
- [ ] クエリ拡張→検索→Fusion→圧縮パイプライン実装
- [ ] 設定別RAG戦略選択機能実装
- [ ] パフォーマンス監視・ログ実装
- [ ] エラーハンドリング・リトライ実装
- [ ] 結果キャッシュ機能実装

### 技術要件
- 使用技術: 全RAGモジュール統合, asyncio, FastAPI
- 制約事項: レスポンス時間15秒以内、高品質回答生成

### テスト項目
- [ ] 統合RAGパイプラインテスト
- [ ] パフォーマンステスト
- [ ] エラーケースハンドリングテスト
- [ ] 品質評価テスト

### 完了条件
- [ ] Advanced RAG機能動作確認
- [ ] パフォーマンス要件確認
- [ ] 品質基準確認

---

## RAG-012: チェック機能API実装
**優先度**: High
**カテゴリ**: API
**依存関係**: RAG-005, RAG-006, RAG-010, INFRA-001

### 課題概要
`POST /rag/check`エンドポイントを実装し、コンプライアンス、約款、表記チェック機能を提供する。

### 実装詳細
- [ ] チェックリクエストモデル定義 (check_type: compliance/term/expression)
- [ ] チェック専用検索戦略実装
- [ ] コンプライアンスチェックロジック実装
- [ ] 約款チェックロジック実装
- [ ] 表記チェックロジック実装
- [ ] 重要度判定・分類機能実装
- [ ] チェック結果構造化実装
- [ ] バッチチェック機能実装

### 技術要件
- 使用技術: LangChain, Bedrock Claude, 検索モジュール統合
- 制約事項: 同期処理、レスポンス時間10秒以内

### テスト項目
- [ ] 各チェック機能テスト
- [ ] 重要度判定精度テスト
- [ ] バッチ処理テスト
- [ ] パフォーマンステスト

### 完了条件
- [ ] 全チェック機能動作確認
- [ ] 精度基準確認
- [ ] パフォーマンス要件確認

---

## RAG-013: 文書管理API実装
**優先度**: Medium
**カテゴリ**: API
**依存関係**: RAG-010, RAG-015

### 課題概要
文書アップロード、処理、管理のCRUD APIを実装する。docling統合によるPDF処理を含む。

### 実装詳細
- [ ] `POST /documents/upload` - docling統合アップロード実装
- [ ] `GET /documents` - 文書一覧取得実装
- [ ] `GET /documents/{document_id}` - 文書詳細取得実装
- [ ] `DELETE /documents/{document_id}` - 文書削除実装
- [ ] S3アップロード・メタデータ管理実装
- [ ] DynamoDB Documents テーブル連携実装
- [ ] 文書処理ステータス管理実装
- [ ] ファイル形式検証・制限実装

### 技術要件
- 使用技術: boto3, docling, FastAPI File Upload
- 制約事項: ファイルサイズ10MB制限、PDF/CSV/TXT対応

### テスト項目
- [ ] アップロード機能テスト
- [ ] CRUD操作テスト
- [ ] ファイル制限テスト
- [ ] エラーハンドリングテスト

### 完了条件
- [ ] 文書管理機能動作確認
- [ ] docling統合確認
- [ ] エラーハンドリング確認

---

## RAG-014: 履歴・設定管理API実装
**優先度**: Medium
**カテゴリ**: API
**依存関係**: RAG-010

### 課題概要
検索履歴、設定管理、サンドボックス機能のAPIを実装する。

### 実装詳細
- [ ] `GET /history/search` - 検索履歴取得実装
- [ ] `GET /history/checks` - チェック履歴取得実装
- [ ] `GET /config` - 設定情報取得実装
- [ ] `GET /sandbox/prompts` - プロンプト管理実装
- [ ] DynamoDB履歴テーブル連携実装
- [ ] ページネーション機能実装
- [ ] フィルタ・検索機能実装
- [ ] 設定検証・ヘルスチェック実装

### 技術要件
- 使用技術: boto3, Pydantic, DynamoDB Query
- 制約事項: ページネーション必須、TTL管理

### テスト項目
- [ ] 履歴管理機能テスト
- [ ] ページネーション機能テスト
- [ ] 設定管理機能テスト

### 完了条件
- [ ] 履歴管理機能確認
- [ ] 設定管理機能確認
- [ ] ページネーション動作確認

---

# ドキュメント処理モジュール

## RAG-015: docling統合ドキュメント処理システム実装
**優先度**: High
**カテゴリ**: ドキュメント処理
**依存関係**: RAG-001

### 課題概要
doclingライブラリを使用したPDF文書処理システムを実装する。高品質な文書解析とメタデータ抽出を行う。

### 実装詳細
- [ ] Docling統合基盤実装
- [ ] PDF文書構造解析実装
- [ ] テキスト抽出・クリーニング実装
- [ ] 表・図・画像メタデータ抽出実装
- [ ] 文書階層構造認識実装
- [ ] 品質評価・検証機能実装
- [ ] バッチ処理機能実装
- [ ] エラーハンドリング・リトライ実装

### 技術要件
- 使用技術: docling, PyPDF2, python-magic
- 制約事項: PDF品質依存、処理時間制限、メモリ制限

### テスト項目
- [ ] PDF解析機能テスト
- [ ] メタデータ抽出テスト
- [ ] 品質評価テスト
- [ ] バッチ処理テスト

### 完了条件
- [ ] docling統合動作確認
- [ ] 解析品質基準確認
- [ ] バッチ処理確認

---

## RAG-016: 高度チャンキング戦略実装
**優先度**: High
**カテゴリ**: ドキュメント処理
**依存関係**: RAG-015

### 課題概要
文書の特性に応じた複数のチャンキング戦略を実装する。構造認識、セマンティック、固定長チャンキングを提供する。

### 実装詳細
- [ ] SemanticChunker実装 (意味的境界認識)
- [ ] StructureChunker実装 (文書構造ベース)
- [ ] CharacterChunker実装 (固定長・オーバーラップ)
- [ ] HybridChunker実装 (複合戦略)
- [ ] チャンク品質評価機能実装
- [ ] チャンクサイズ最適化実装
- [ ] メタデータ継承機能実装
- [ ] チャンキング戦略選択ロジック実装

### 技術要件
- 使用技術: LangChain Text Splitters, spaCy, NLTK
- 制約事項: チャンクサイズ最適化、重複制御、品質保証

### テスト項目
- [ ] 各チャンキング戦略テスト
- [ ] 品質評価テスト
- [ ] パフォーマンステスト
- [ ] 戦略選択テスト

### 完了条件
- [ ] 全チャンキング戦略動作確認
- [ ] 品質基準確認
- [ ] 戦略選択機能確認

---

## RAG-017: ベクトル化・Pineconeインデックス処理システム実装
**優先度**: High
**カテゴリ**: ドキュメント処理
**依存関係**: RAG-016, RAG-005, INFRA-013, INFRA-014

### 課題概要
チャンク化された文書のベクトル化とPinecone登録を効率的に処理するシステムを実装する。

### 実装詳細
- [ ] バッチベクトル化処理実装
- [ ] Embedding品質検証実装
- [ ] Pinecone統合・登録実装
- [ ] メタデータ構造化・登録実装 (document_id, category, tags等)
- [ ] Pineconeインデックス最適化実装
- [ ] 処理進捗管理実装
- [ ] Pinecone API制限対応・エラー処理・リトライ実装
- [ ] 処理結果検証実装
- [ ] Pinecone利用料金監視実装

### 技術要件
- 使用技術: Bedrock Embeddings, Pinecone SDK, boto3
- 制約事項: バッチサイズ最適化、Pinecone API制限対応、品質保証、コスト最適化

### テスト項目
- [ ] バッチ処理テスト
- [ ] ベクトル化品質テスト
- [ ] Pinecone登録テスト
- [ ] API制限・エラー処理テスト

### 完了条件
- [ ] ベクトル化処理動作確認
- [ ] Pinecone統合確認
- [ ] 品質基準確認

---

## RAG-018: 文書処理パイプライン統合実装
**優先度**: Medium
**カテゴリ**: ドキュメント処理
**依存関係**: RAG-015, RAG-016, RAG-017, INFRA-002, INFRA-007

### 課題概要
S3イベントトリガーによる文書処理パイプライン全体を統合実装する。アップロードから検索可能状態までの自動処理を行う。

### 実装詳細
- [ ] S3イベントハンドラー実装
- [ ] 処理パイプライン統合実装
- [ ] ステータス管理・追跡実装
- [ ] DynamoDB状態更新実装
- [ ] エラー通知・アラート実装
- [ ] 処理ログ・監視実装
- [ ] パフォーマンス最適化実装
- [ ] 並列処理制御実装

### 技術要件
- 使用技術: AWS Lambda, S3 Events, DynamoDB Streams
- 制約事項: 非同期処理、エラー耐性、監視必須

### テスト項目
- [ ] パイプライン統合テスト
- [ ] エラー処理テスト
- [ ] 並列処理テスト
- [ ] 監視機能テスト

### 完了条件
- [ ] パイプライン統合動作確認
- [ ] エラー処理確認
- [ ] 監視機能確認

---

# セキュリティ・運用

## RAG-019: セキュリティ・監査機能実装
**優先度**: Medium
**カテゴリ**: セキュリティ
**依存関係**: RAG-010

### 課題概要
セキュリティ要件に沿った暗号化、監査ログ、機密情報保護機能を実装する。

### 実装詳細
- [ ] リクエスト・レスポンス機密情報マスキング実装
- [ ] セキュリティヘッダー実装
- [ ] 監査ログ・アクセスログ実装
- [ ] APIレート制限実装
- [ ] セキュリティ設定検証実装
- [ ] 脆弱性スキャン対応実装

### 技術要件
- 使用技術: FastAPI middleware, CloudWatch, boto3
- 制約事項: 機密情報保護、認証はAPI Gateway側で実装

### テスト項目
- [ ] セキュリティ機能テスト
- [ ] 監査ログテスト
- [ ] 機密情報保護テスト

### 完了条件
- [ ] セキュリティ機能動作確認
- [ ] 監査ログ動作確認
- [ ] 機密情報保護確認